{# Allows the DOCTYPE to be set on a page by page basis #}
{%- block doctype %}
<!DOCTYPE html>
{% endblock -%}

    {# Allows custom attributes to be added to the <html> tag #}
    {%- block htmltag -%}
        {% set lang = h.lang() %}
        <!--[if IE 9]> <html lang="{{ lang }}" class="ie9"> <![endif]-->
        <!--[if gt IE 8]><!-->
        <html lang="{{ lang }}" {% if h.is_rtl_language()  %} dir="rtl" {% endif %}>
        <!--<![endif]-->
    {%- endblock -%}

    <head{% block headtag %}{% endblock %}>
        {%- block meta -%}
        <meta charset="utf-8" />
        <meta name="csrf_field_name" content="{{ g.csrf_field_name }}" />
        <meta name="{{ g.csrf_field_name }}" content="{{ csrf_token() }}" />

        {% block meta_generator %}
        <meta name="generator" content="ckan {{ h.ckan_version() }}" />{% endblock %}
        {% block meta_viewport %}
        <meta name="viewport" content="width=device-width, initial-scale=1.0">{% endblock %}
        {%- endblock -%}
        <title>
            {%- block title -%}
            {%- block subtitle %}{% endblock -%}
            {%- if self.subtitle()|trim %} {{ g.template_title_delimiter }} {% endif -%}
            {{ g.site_title }}
            {%- endblock -%}
        </title>
        <!-- format: asset 'extension name / css filename' i think extension name includes filepath -->
        {% block styles %}
            {% set theme = h.get_rtl_theme() if h.is_rtl_language() else g.theme %}
            {% asset theme %}
            {% asset 'iauthfunctions/grouptable' %}
        {% endblock %}
    </head>
    <body>
        {%- block header %}
            {% include "header.html" %}
        {% endblock -%}

        {% import "macros/form.html" as form %}
        <table>
            <tr>
                <td><b>User IDs</b></td>
            </tr>
            {% for user_id in userlist %}
                <tr>
                    <td>{{ user_id }}</td>
                </tr>
            {% endfor %}
        </table>
            {% block form %}
                {{ h.csrf_input() }} 
                {% block error_summary %}
                    {{ form.errors(error_summary) }}
                {% endblock %}
                <form id="group-edit" class="dataset-form" action="listOfUsers" method="post" data-module="basic-form" enctype="multipart/form-data">
                    {% block basic_fields %}
                        {% if group_details == None %}
                            <h1>CREATING GROUP FORM</h1>
                            {% set attrs = {'data-module': 'slug-preview-target', 'class': 'form-control'} %}
                            {{ form.hidden(name='editType', value='create') }}

                            {{ form.input('title', label=_('Name'), id='field-name', placeholder= _('My Group'), classes=['control-full'], attrs=attrs) }}
                            {{ form.prepend('name', label=_('URL'), prepend=prefix, id='field-url', placeholder=_('my-group'), attrs=attrs, is_required=true) }}
                            {{ form.markdown('description', label=_('Description'), id='field-description', placeholder=_('A little information about my group...')) }}
                        {% else %}
                            <h1>EDITING {{ group_details[0]['title'] }} FORM</h1>
                            {% set attrs = {'data-module': 'slug-preview-target', 'class': 'form-control'} %}
                            {{ form.hidden(name='editType', value='edit') }}

                            {{ form.input('title', label=_('Name'), id='field-name', placeholder= _('My Group'), classes=['control-full'], attrs=attrs, value=group_details[0]['title']) }}
                            {{ form.prepend('name', label=_('URL'), prepend=prefix, id='field-url', placeholder=_('my-group'), attrs=attrs, is_required=true, value=group_details[0]['name']) }}
                            {{ form.markdown('description', label=_('Description'), id='field-description', placeholder=_('A little information about my group...'), value=group_details[0]['description']) }}
                        {% endif %}
                    {% endblock %}
                    
                    {{ form.required_message() }}

                    <div class="form-actions">
                        <input class="btn btn-primary" name="save" type="submit">{% block save_text %}{{ _('Save Group') }}{% endblock %}</input>
                    </div>
                </form>
            {% endblock %}
        <div>
            {% if result != None %}
                <h2>This is the new group that is created</h2>
                {% for key, val in result.items() %}
                    <p>{{ key }} : {{ val }}</p>
                {% endfor %}
            {% endif %}
        </div>
        {%- block footer %}
            {% include "footer.html" %}
        {% endblock -%}
        
        {{ h.render_assets('style') }}
        {{ h.render_assets('script') }}
    </body>
</html>